<!DOCTYPE html>
<html>
<head>
  <title>Lakshmi Motor Cycle Spares</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>

<body style="font-family: Arial; padding: 20px; background:#f4f4f4;">

<!-- ================= SHOP BRANDING ================= -->
<div style="text-align:center;padding:15px;margin-bottom:15px;background:#fff;border-radius:8px;">
  <h1 style="margin:0;font-size:22px;">üèçÔ∏è LAKSHMI MOTOR CYCLE SPARES</h1>
  <p style="margin:5px 0;color:#555;">Genuine 2-Wheeler Spare Parts</p>
  <p style="margin:5px 0;color:#777;">üöö Fast Delivery ‚Ä¢ üíØ Trusted Store</p>
</div>

<h3>üõµ Select Your Bike</h3>

<label>Brand</label>
<select id="brandSelect" style="width:100%;padding:10px;"></select><br><br>

<label>Model</label>
<select id="modelSelect" style="width:100%;padding:10px;"></select><br><br>

<label>Year</label>
<select id="yearSelect" style="width:100%;padding:10px;"></select><br><br>

<h3>Category</h3>
<div id="categories"></div>

<h3>Available Parts</h3>
<div id="parts"></div>

<script>
/* ================= CONFIG ================= */
const telegramUserId = Telegram.WebApp.initDataUnsafe?.user?.id || 0;
const SUPABASE_URL = "https://gmajjousigloyiablmeo.supabase.co";
const SUPABASE_KEY = "sb_publishable_anzjPC7WhQVAzPP1JSAm4g_W-G90zZY";
const GOOGLE_MAPS_API_KEY = ""; // add key later in production
const ADMIN_CHAT_ID = "835405399";

/* ================= ELEMENTS ================= */
const brandSelect = document.getElementById("brandSelect");
const modelSelect = document.getElementById("modelSelect");
const yearSelect  = document.getElementById("yearSelect");
const categoryDiv = document.getElementById("categories");
const partsDiv    = document.getElementById("parts");

/* ================= LOAD BRANDS ================= */
async function loadBrands() {
  brandSelect.innerHTML = `<option value="">Select Brand</option>`;
  modelSelect.innerHTML = `<option value="">Select Model</option>`;
  yearSelect.innerHTML  = `<option value="">Select Year</option>`;
  categoryDiv.innerHTML = "";
  partsDiv.innerHTML = "";

  const res = await fetch(`${SUPABASE_URL}/rest/v1/bike_brands?select=id,brand_name`,
    { headers:{apikey:SUPABASE_KEY,Authorization:`Bearer ${SUPABASE_KEY}`}});
  const data = await res.json();
  data.forEach(b => brandSelect.innerHTML += `<option value="${b.id}">${b.brand_name}</option>`);
}

/* ================= LOAD MODELS ================= */
async function loadModels(id) {
  modelSelect.innerHTML = `<option value="">Select Model</option>`;
  yearSelect.innerHTML = `<option value="">Select Year</option>`;
  categoryDiv.innerHTML = "";
  partsDiv.innerHTML = "";

  const res = await fetch(`${SUPABASE_URL}/rest/v1/bike_models?brand_id=eq.${id}&select=id,model_name`,
    { headers:{apikey:SUPABASE_KEY,Authorization:`Bearer ${SUPABASE_KEY}`}});
  const data = await res.json();
  data.forEach(m => modelSelect.innerHTML += `<option value="${m.id}">${m.model_name}</option>`);
}

/* ================= LOAD YEARS ================= */
async function loadYears(id) {
  yearSelect.innerHTML = `<option value="">Select Year</option>`;
  categoryDiv.innerHTML = "";
  partsDiv.innerHTML = "";

  const res = await fetch(`${SUPABASE_URL}/rest/v1/bike_years?model_id=eq.${id}&select=id,year`,
    { headers:{apikey:SUPABASE_KEY,Authorization:`Bearer ${SUPABASE_KEY}`}});
  const data = await res.json();
  data.forEach(y => yearSelect.innerHTML += `<option value="${y.id}">${y.year}</option>`);
}

/* ================= LOAD CATEGORIES ================= */
async function loadCategories() {
  categoryDiv.innerHTML = "";
  partsDiv.innerHTML = "";

  const res = await fetch(`${SUPABASE_URL}/rest/v1/categories?select=id,category_name`,
    { headers:{apikey:SUPABASE_KEY,Authorization:`Bearer ${SUPABASE_KEY}`}});
  const data = await res.json();

  data.forEach(c => {
    const btn = document.createElement("button");
    btn.textContent = c.category_name;
    btn.style.cssText = "width:100%;padding:12px;margin-bottom:8px;";
    btn.onclick = () => loadParts(c.id);
    categoryDiv.appendChild(btn);
  });
}

/* ================= LOAD PARTS ================= */
async function loadParts(categoryId) {
  partsDiv.innerHTML = "Loading parts...";

  const res = await fetch(
    `${SUPABASE_URL}/rest/v1/spare_parts?brand_id=eq.${brandSelect.value}&model_id=eq.${modelSelect.value}&year_id=eq.${yearSelect.value}&category_id=eq.${categoryId}&select=id,part_name,price,stock_qty,image_url`,
    { headers:{apikey:SUPABASE_KEY,Authorization:`Bearer ${SUPABASE_KEY}`}});
  const parts = await res.json();

  partsDiv.innerHTML = "";
  if (!parts.length) return partsDiv.innerHTML = "No parts available";

  parts.forEach(p => {
  partsDiv.innerHTML += `
    <div style="
      background:#fff;
      padding:10px;
      margin-bottom:10px;
      border-radius:8px;
      display:flex;
      gap:10px;
      align-items:center;
    ">

      <!-- IMAGE -->
      <img 
  src="${p.image_url || 'https://via.placeholder.com/80'}"
  style="width:80px;height:80px;object-fit:contain;cursor:pointer;"
  onclick="handleImageClick('${p.id}','${p.image_url || ''}')"
/>

      <!-- DETAILS -->
      <div style="flex:1;">
        <b>${p.part_name}</b><br>
        ‚Çπ${p.price}<br>
        Stock: ${p.stock_qty}<br><br>

        <button onclick="addToCartWithVariant('${p.id}', ${p.price})">
          Add to Cart
        </button>
      </div>

    </div>
  `;
});

  partsDiv.innerHTML += `<button onclick="loadCart()" style="width:100%;padding:12px;">üõí View Cart</button>`;
}
/* ================= UN NAMED ================= */
async function addToCartWithVariant(partId, basePrice) {
  const color = window.selectedColor || null;
  const price = window.selectedPrice || basePrice;

  await fetch(`${SUPABASE_URL}/rest/v1/cart_items`, {
    method: "POST",
    headers: {
      apikey: SUPABASE_KEY,
      Authorization: `Bearer ${SUPABASE_KEY}`,
      "Content-Type": "application/json"
    },
    body: JSON.stringify({
      telegram_user_id: telegramUserId,
      spare_part_id: partId,
      color: color,
      quantity: 1,
      price: price
    })
  });

  alert("Added to cart");
}
  
/* ================= ADD TO CART ================= */
async function addToCart(partId, price) {
  const check = await fetch(
    `${SUPABASE_URL}/rest/v1/cart_items?telegram_user_id=eq.${telegramUserId}&spare_part_id=eq.${partId}&select=id,quantity`,
    { headers:{apikey:SUPABASE_KEY,Authorization:`Bearer ${SUPABASE_KEY}`}});
  const data = await check.json();

  if (data.length) {
    await fetch(`${SUPABASE_URL}/rest/v1/cart_items?id=eq.${data[0].id}`,{
      method:"PATCH",
      headers:{apikey:SUPABASE_KEY,Authorization:`Bearer ${SUPABASE_KEY}`,"Content-Type":"application/json"},
      body:JSON.stringify({quantity:data[0].quantity+1})
    });
  } else {
    await fetch(`${SUPABASE_URL}/rest/v1/cart_items`,{
      method:"POST",
      headers:{apikey:SUPABASE_KEY,Authorization:`Bearer ${SUPABASE_KEY}`,"Content-Type":"application/json"},
      body:JSON.stringify({telegram_user_id:telegramUserId,spare_part_id:partId,quantity:1,price})
    });
  }
  alert("Added to cart");
}

/* ================= LOAD CART ================= */
async function loadCart() {
  partsDiv.innerHTML = "Loading cart...";

  const res = await fetch(
    `${SUPABASE_URL}/rest/v1/cart_items?telegram_user_id=eq.${telegramUserId}&select=id,quantity,price,spare_part_id`,
    {
      headers: {
        apikey: SUPABASE_KEY,
        Authorization: `Bearer ${SUPABASE_KEY}`
      }
    }
  );

  const items = await res.json();

  if (items.length === 0) {
    partsDiv.innerHTML = "Cart is empty";
    return;
  }

  let subtotal = 0;
  partsDiv.innerHTML = "<h3>Your Cart</h3>";

  for (const i of items) {
    // üîπ Fetch spare part name
    const partRes = await fetch(
      `${SUPABASE_URL}/rest/v1/spare_parts?id=eq.${i.spare_part_id}&select=part_name`,
      {
        headers: {
          apikey: SUPABASE_KEY,
          Authorization: `Bearer ${SUPABASE_KEY}`
        }
      }
    );

    const partData = await partRes.json();
    const partName = partData[0]?.part_name || "Unknown Part";

    const itemTotal = i.price * i.quantity;
    subtotal += itemTotal;

    partsDiv.innerHTML += `
      <div style="border:1px solid #ccc;padding:10px;margin-bottom:8px;">
        <b>${partName}</b><br>
        ‚Çπ${i.price} √ó ${i.quantity} = ‚Çπ${itemTotal}<br><br>

        <button onclick="updateQty('${i.id}', ${i.quantity - 1})">‚àí</button>
        <button onclick="updateQty('${i.id}', ${i.quantity + 1})">+</button>
        <button onclick="removeCartItem('${i.id}')">‚ùå Remove</button>
      </div>
    `;
  }

  partsDiv.innerHTML += `
    <hr>
    Subtotal: ‚Çπ${subtotal}<br>
    Delivery: ‚Çπ200<br>
    <b>Total: ‚Çπ${subtotal + 200}</b><br><br>

    <button onclick="showCheckout()" style="padding:14px;width:100%;">
      ‚úÖ Proceed to Checkout
    </button>
  `;
}

/* ================= CHECKOUT ================= */
async function showCheckout() {
  partsDiv.innerHTML = "Loading order summary...";

  // 1Ô∏è‚É£ Fetch cart items
  const res = await fetch(
    `${SUPABASE_URL}/rest/v1/cart_items?telegram_user_id=eq.${telegramUserId}&select=quantity,price,spare_part_id`,
    {
      headers: {
        apikey: SUPABASE_KEY,
        Authorization: `Bearer ${SUPABASE_KEY}`
      }
    }
  );

  const items = await res.json();

  if (items.length === 0) {
    partsDiv.innerHTML = "Cart is empty";
    return;
  }

  let subtotal = 0;
  let summaryHTML = `<h3>üßæ Order Summary</h3>`;

  // 2Ô∏è‚É£ Show ordered items
  for (const i of items) {
    const partRes = await fetch(
      `${SUPABASE_URL}/rest/v1/spare_parts?id=eq.${i.spare_part_id}&select=part_name`,
      {
        headers: {
          apikey: SUPABASE_KEY,
          Authorization: `Bearer ${SUPABASE_KEY}`
        }
      }
    );

    const partData = await partRes.json();
    const partName = partData[0]?.part_name || "Spare Part";

    const itemTotal = i.price * i.quantity;
    subtotal += itemTotal;

    summaryHTML += `
      <div style="border:1px solid #ddd;padding:8px;margin-bottom:6px;">
        <b>${partName}</b><br>
        ‚Çπ${i.price} √ó ${i.quantity} = ‚Çπ${itemTotal}
      </div>
    `;
  }

  summaryHTML += `
    <hr>
    Subtotal: ‚Çπ${subtotal}<br>
    Delivery: ‚Çπ200<br>
    <b>Total: ‚Çπ${subtotal + 200}</b>
    <hr>
  `;

  // 3Ô∏è‚É£ Append checkout form BELOW summary
  partsDiv.innerHTML = `
    ${summaryHTML}

    <h3>üì¶ Delivery Address</h3>

    <input id="name" placeholder="Full Name*" style="width:100%;padding:8px"><br><br>
    <input id="phone" placeholder="Phone*" style="width:100%;padding:8px"><br><br>
    <input id="email" placeholder="Email (optional)" style="width:100%;padding:8px"><br><br>
    <input id="flat" placeholder="Flat / House No*" style="width:100%;padding:8px"><br><br>
    <input id="area" placeholder="Area / Street*" style="width:100%;padding:8px"><br><br>
    <input id="city" placeholder="City*" style="width:100%;padding:8px"><br><br>
    <input id="state" placeholder="State*" style="width:100%;padding:8px"><br><br>
    <input id="pincode" placeholder="Pincode*" style="width:100%;padding:8px"><br><br>

    <button onclick="getLocation()" style="width:100%;padding:12px;">
      üìç Use Current Location
    </button>
    <br><br>

    <h3>üí≥ Payment Method</h3>

    <label><input type="radio" name="payment" value="COD" checked> Cash on Delivery</label><br><br>
    <label><input type="radio" name="payment" value="UPI"> UPI</label><br><br>
    <label><input type="radio" name="payment" value="RAZORPAY"> Online Payment</label><br><br>

    <button onclick="confirmPayment()" style="width:100%;padding:14px;">
      ‚úÖ Confirm & Place Order
    </button>
  `;
}

/* ================= ADD GEO LOCATION ================= */
  function getLocation() {
  // If API key is not added yet
  if (!GOOGLE_MAPS_API_KEY) {
    alert(
      "üìç Auto location will be enabled in production.\n" +
      "Please enter address manually for now."
    );
    return;
  }

  // This part will be used later (prod)
  if (!navigator.geolocation) {
    alert("Geolocation not supported on this device");
    return;
  }

  navigator.geolocation.getCurrentPosition(
    position => {
      const lat = position.coords.latitude;
      const lng = position.coords.longitude;
      reverseGeocode(lat, lng);
    },
    () => alert("Location permission denied")
  );
}

/* ================= WORKING LOGIC ONCE GOOGLE MAPS KEY ADDS ================= */
  async function reverseGeocode(lat, lng) {
  const url =
    `https://maps.googleapis.com/maps/api/geocode/json?latlng=${lat},${lng}&key=${GOOGLE_MAPS_API_KEY}`;

  const res = await fetch(url);
  const data = await res.json();

  if (data.status !== "OK") {
    alert("Unable to fetch address");
    return;
  }

  const components = data.results[0].address_components;

  const get = type =>
    components.find(c => c.types.includes(type))?.long_name || "";

  document.getElementById("area").value = get("route") || get("sublocality");
  document.getElementById("city").value = get("locality");
  document.getElementById("state").value = get("administrative_area_level_1");
  document.getElementById("pincode").value = get("postal_code");
}

/* ================= ADD PAYMENT DECISION LOGIC ================= */
  function confirmPayment() {
  const paymentMethod =
    document.querySelector('input[name="payment"]:checked')?.value;

  if (!paymentMethod) {
    alert("Please select a payment method");
    return;
  }

  if (paymentMethod === "COD") {
    placeOrder("COD");
  } 
  else if (paymentMethod === "UPI") {
    alert("UPI payment coming next (GPay / PhonePe)");
    // next step
  } 
  else if (paymentMethod === "RAZORPAY") {
    alert("Razorpay integration coming next");
    // next step
  }
}
/* ================= ADD QUANTITY UPDATE FUNCTION ================= */
async function updateQty(cartItemId, newQty) {
  if (newQty <= 0) {
    removeCartItem(cartItemId);
    return;
  }

  await fetch(
    `${SUPABASE_URL}/rest/v1/cart_items?id=eq.${cartItemId}`,
    {
      method: "PATCH",
      headers: {
        apikey: SUPABASE_KEY,
        Authorization: `Bearer ${SUPABASE_KEY}`,
        "Content-Type": "application/json"
      },
      body: JSON.stringify({ quantity: newQty })
    }
  );

  loadCart();
}

async function removeCartItem(id) {
  await fetch(
    `${SUPABASE_URL}/rest/v1/cart_items?id=eq.${id}`,
    {
      method: "DELETE",
      headers: {
        apikey: SUPABASE_KEY,
        Authorization: `Bearer ${SUPABASE_KEY}`
      }
    }
  );

  loadCart();
}
  
/* ================= HANDLE BODY PART COLOURS ================= */
async function handleImageClick(partId, imageUrl) {
  openImageModal(imageUrl || "https://via.placeholder.com/400");

  const res = await fetch(
    `${SUPABASE_URL}/rest/v1/body_part_variants?spare_part_id=eq.${partId}&select=color,image_url,price`,
    {
      headers: {
        apikey: SUPABASE_KEY,
        Authorization: `Bearer ${SUPABASE_KEY}`
      }
    }
  );

  const variants = await res.json();
  if (!variants.length) return;

  const colorDiv = document.getElementById("colorVariants");
  colorDiv.innerHTML = "";

  variants.forEach(v => {
    const btn = document.createElement("img");
    btn.src = v.image_url;
    btn.title = v.color;

    btn.style.cssText = `
      width:60px;
      height:60px;
      object-fit:contain;
      border:2px solid #fff;
      border-radius:6px;
      cursor:pointer;
      background:#fff;
    `;

    btn.onclick = () => {
      document.getElementById("modalImage").src = v.image_url;
      document.getElementById("modalPrice").innerText = "‚Çπ" + v.price;
      window.selectedColor = v.color;
      window.selectedPrice = v.price;
    };

    colorDiv.appendChild(btn);
  });
}
  
/* ================= PLACE ORDER ================= */
async function placeOrder(paymentMethod) {
  const name = document.getElementById("name").value.trim();
  const phone = document.getElementById("phone").value.trim();
  // üìû PHONE VALIDATION (India ‚Äì 10 digits)
if (!/^[0-9]{10}$/.test(phone)) {
  alert("Please enter a valid 10-digit mobile number");
  return; // ‚õî stop order
}
  const emailInput = document.getElementById("email");
 const email = emailInput && emailInput.value ? emailInput.value.trim() : null;

  // üîç OPTIONAL EMAIL VALIDATION
if (email && !email.includes("@")) {
  alert("Please enter a valid email address");
  return; // ‚õî STOP order creation
}
  const flat = document.getElementById("flat").value.trim();
  const area = document.getElementById("area").value.trim();
  const city = document.getElementById("city").value.trim();
  const state = document.getElementById("state").value.trim();
  const pincode = document.getElementById("pincode").value.trim();
  // üìç PIN CODE VALIDATION (India ‚Äì 6 digits)
if (!/^[0-9]{6}$/.test(pincode)) {
  alert("Please enter a valid 6-digit PIN code");
  return; // ‚õî stop order
}

  if (!name || !phone || !flat || !area || !city || !state || !pincode) {
    alert("Fill all required fields");
    return;
  }

  const address = `${flat}, ${area}, ${city}, ${state} - ${pincode}`;

  // 1Ô∏è‚É£ Get cart items
  const cartRes = await fetch(
    `${SUPABASE_URL}/rest/v1/cart_items?telegram_user_id=eq.${telegramUserId}&select=spare_part_id,quantity,price`,
    {
      headers: {
        apikey: SUPABASE_KEY,
        Authorization: `Bearer ${SUPABASE_KEY}`
      }
    }
  );

  const cartItems = await cartRes.json();

  if (cartItems.length === 0) {
    alert("Cart is empty");
    return;
  }

  // 2Ô∏è‚É£ Calculate totals
  let subtotal = 0;
  cartItems.forEach(i => {
    subtotal += i.price * i.quantity;
  });

  const deliveryFee = 200;
  const totalAmount = subtotal + deliveryFee;

  // ================= CREATE ORDER (COD) =================

const orderRes = await fetch(
  `${SUPABASE_URL}/rest/v1/orders`,
  {
    method: "POST",
    headers: {
      apikey: SUPABASE_KEY,
      Authorization: `Bearer ${SUPABASE_KEY}`,
      "Content-Type": "application/json",
      Prefer: "return=representation"
      
    },
    body: JSON.stringify({
      telegram_user_id: telegramUserId,
      customer_name: name,
      phone: phone,
      email: email || null,
      address: address,
      subtotal: subtotal,
      delivery_fee: 200,
      total_amount: totalAmount,
      payment_method: "COD",
      payment_status: "UNPAID",
      order_status: "CREATED"
    })
  }
);
/* ================= ERROR HANDLING AROUND ORDER INSERT ================= */
if (!orderRes.ok) {
  const err = await orderRes.text();
  alert("Order failed: " + err);
  return;
}

const orderData = await orderRes.json();
/* ================= END OF ERROR HANDLING AROUND ORDER INSERT ================= */
const orderId = orderData[0].id;
await notifyAdmin({
  id: orderId,
  customer_name: name,
  phone: phone,
  address: address,
  total_amount: totalAmount
});
/* ================= edge case  ================= */
// üîπ SAVE ORDER ITEMS
for (const item of cartItems) {
  await fetch(`${SUPABASE_URL}/rest/v1/order_items`, {
    method: "POST",
    headers: {
      apikey: SUPABASE_KEY,
      Authorization: `Bearer ${SUPABASE_KEY}`,
      "Content-Type": "application/json"
    },
    body: JSON.stringify({
      order_id: orderId,
      spare_part_id: item.spare_part_id,
      quantity: item.quantity,
      price: item.price
    })
  });
}

/* ================= CALL EMAIL FUNCTION FROM WEB APP ================= */
// üìß Send invoice email (if email exists)
if (email) {

  // Fetch ordered items with names
  const itemRes = await fetch(
    `${SUPABASE_URL}/rest/v1/order_items?order_id=eq.${orderId}&select=quantity,price,spare_part_id`,
    { headers:{apikey:SUPABASE_KEY,Authorization:`Bearer ${SUPABASE_KEY}`} }
  );

  const rawItems = await itemRes.json();

  const items = [];
  for (const i of rawItems) {
    const partRes = await fetch(
      `${SUPABASE_URL}/rest/v1/spare_parts?id=eq.${i.spare_part_id}&select=part_name`,
      { headers:{apikey:SUPABASE_KEY,Authorization:`Bearer ${SUPABASE_KEY}`} }
    );
    const part = await partRes.json();
    items.push({
      part_name: part[0].part_name,
      quantity: i.quantity,
      price: i.price
    });
  }

  await fetch(
  "https://gmajjousigloyiablmeo.functions.supabase.co/notify-admin",
  {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "Authorization": `Bearer ${SUPABASE_KEY}`
    },
    body: JSON.stringify({
      id: orderId,
      customer_name: name,
      phone,
      address,
      total_amount: totalAmount
    })
  }
);

}

  
/* ================= Clear cart ================= */
  // 4Ô∏è‚É£ Clear cart
  await fetch(
    `${SUPABASE_URL}/rest/v1/cart_items?telegram_user_id=eq.${telegramUserId}`,
    {
      method: "DELETE",
      headers: {
        apikey: SUPABASE_KEY,
        Authorization: `Bearer ${SUPABASE_KEY}`
      }
    }
  );

  // 5Ô∏è‚É£ Confirmation
  partsDiv.innerHTML = `
    <h3>üéâ Order Placed Successfully</h3>
    <p><b>Order ID:</b> ${orderId}</p>
    <p><b>Payment:</b> ${paymentMethod}</p>
    <p><b>Total:</b> ‚Çπ${totalAmount}</p>
    <p><b>Address:</b><br>${address}</p>
  `;
}

/* ================= EVENTS ================= */
brandSelect.onchange=()=>loadModels(brandSelect.value);
modelSelect.onchange=()=>loadYears(modelSelect.value);
yearSelect.onchange=()=>loadCategories();
loadBrands();
/* ================= ADD MODAL FUNCTIONS (JS) ================= */
function openImageModal(imageUrl) {
  document.getElementById("modalImage").src = imageUrl;
  document.getElementById("colorVariants").innerHTML = "";
  document.getElementById("imageModal").style.display = "flex";
}

function closeModal() {
  document.getElementById("imageModal").style.display = "none";
}
/* ================= ADD FUNCTION TO SEND ADMIN ALERT ================= */
  async function notifyAdmin(order) {
  const message = `
üÜï *NEW COD ORDER*

üßæ Order ID: ${order.id}
üë§ Name: ${order.customer_name}
üìû Phone: ${order.phone}
üí∞ Amount: ‚Çπ${order.total_amount}
üìç Address:
${order.address}

‚è∞ ${new Date().toLocaleString()}
  `;

  const url = `https://api.telegram.org/bot${ADMIN_BOT_TOKEN}/sendMessage`;

  await fetch(url, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      chat_id: ADMIN_CHAT_ID,
      text: message,
      parse_mode: "Markdown"
    })
  });
}
  
</script>
  



<!-- ================= IMAGE MODAL ================= -->
<div id="imageModal" style="
  display:none;
  position:fixed;
  top:0; left:0;
  width:100%; height:100%;
  background:rgba(0,0,0,0.85);
  z-index:9999;
  justify-content:center;
  align-items:center;
  flex-direction:column;
">

  <img id="modalImage" style="
    max-width:90%;
    max-height:70%;
    border-radius:8px;
    background:#fff;
    padding:10px;
  ">
  <p id="modalPrice" style="
  color:#fff;
  font-size:18px;
  margin-top:10px;
">
</p>

  <div id="colorVariants" style="
    margin-top:15px;
    display:flex;
    gap:10px;
    flex-wrap:wrap;
    justify-content:center;
  "></div>

  <button onclick="closeModal()" style="
    margin-top:20px;
    padding:10px 20px;
    font-size:16px;
  ">
    ‚ùå Close
  </button>
</div>
  
</body>
</html>
